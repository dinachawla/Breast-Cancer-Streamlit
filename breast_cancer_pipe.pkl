# train_and_save_model.py  ▸ copy & run locally
import pandas as pd, joblib
from sklearn.pipeline import Pipeline
from sklearn.preprocessing import StandardScaler
from sklearn.neighbors import KNeighborsClassifier

# 1️⃣  Download the Wisconsin Diagnostic Breast-Cancer CSV if you don’t have it.
csv_url = "https://raw.githubusercontent.com/akmand/datasets/master/wdbc.csv"
df = pd.read_csv(csv_url)

# 2️⃣  Keep only the four features your UI collects.
keep = ["radius_mean", "texture_mean", "perimeter_mean", "area_mean"]
X = df[keep]
y = df["diagnosis"].map({"M": 1, "B": 0})   # 1 = Malignant, 0 = Benign

# 3️⃣  Simple pipeline: scale ➜ 5-NN classifier
pipe = Pipeline([
    ("scale", StandardScaler()),
    ("knn",   KNeighborsClassifier(n_neighbors=5))
]).fit(X, y)

# 4️⃣  Save – compress=3 keeps it tiny (<1 MB)
joblib.dump(pipe, "breast_cancer_pipe.pkl", compress=3)
print("✅  Saved breast_cancer_pipe.pkl (size:", Path('breast_cancer_pipe.pkl').stat().st_size, "bytes )")
